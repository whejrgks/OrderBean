# 🏗️ OrderBean 기술 스택 및 아키텍처 리포트

**생성일**: 2024-12-16

---

## 1. 기술 스택

### Frontend

| 기술 | 버전 | 용도 |
|------|------|------|
| React | 18.2.0 | UI 라이브러리 |
| TypeScript | 5.2.2 | 타입 안정성 |
| Vite | 5.0.8 | 빌드 도구 및 개발 서버 |
| React Router | 6.20.0 | 라우팅 |
| Zustand | 4.4.7 | 상태 관리 |
| Axios | 1.6.2 | HTTP 클라이언트 |
| Vitest | 1.0.4 | 테스트 프레임워크 |
| React Testing Library | 14.1.2 | 컴포넌트 테스트 |

### Backend

| 기술 | 버전 | 용도 |
|------|------|------|
| Node.js | 18+ | 런타임 환경 |
| Express | 4.18.2 | 웹 프레임워크 |
| TypeScript | 5.3.3 | 타입 안정성 |
| Prisma | 5.7.1 | ORM 및 데이터베이스 관리 |
| PostgreSQL | 14+ | 데이터베이스 |
| Jest | 29.7.0 | 테스트 프레임워크 |
| Supertest | 6.3.3 | API 테스트 |

---

## 2. 시스템 아키텍처

### 전체 구조

```
┌─────────────┐
│   Client    │  (React + TypeScript)
│  (Browser)  │
└──────┬──────┘
       │ HTTP/REST API
       │
┌──────▼──────┐
│   Backend  │  (Node.js + Express)
│   Server   │
└──────┬──────┘
       │
┌──────▼──────┐
│  Database   │  (PostgreSQL)
│  (Prisma)   │
└─────────────┘
```

### 레이어 구조

#### Frontend
```
┌─────────────────┐
│   Pages         │  (라우팅)
├─────────────────┤
│   Components    │  (UI 컴포넌트)
├─────────────────┤
│   Store         │  (상태 관리)
├─────────────────┤
│   Services      │  (API 호출)
└─────────────────┘
```

#### Backend
```
┌─────────────────┐
│   Routes        │  (라우팅)
├─────────────────┤
│   Controllers   │  (요청 처리)
├─────────────────┤
│   Services      │  (비즈니스 로직)
├─────────────────┤
│   Models        │  (데이터 모델)
├─────────────────┤
│   Database      │  (Prisma ORM)
└─────────────────┘
```

---

## 3. 데이터베이스 스키마

### ERD (Entity Relationship Diagram)

```
Menu (메뉴)
├── id (UUID)
├── name
├── description
├── price
├── category
├── imageUrl
├── isAvailable
└── options (JSON)

Order (주문)
├── id (UUID)
├── customerId
├── status (enum)
├── totalPrice
└── items (1:N)

OrderItem (주문 항목)
├── id (UUID)
├── orderId (FK)
├── menuId (FK)
├── quantity
├── customizations (JSON)
└── price
```

### 관계
- `Menu` 1:N `OrderItem`
- `Order` 1:N `OrderItem`

### 주문 상태 (OrderStatus)
- `PENDING` - 주문 접수
- `PREPARING` - 제조 중
- `READY` - 준비 완료
- `COMPLETED` - 픽업 완료
- `CANCELLED` - 취소됨

---

## 4. API 설계

### RESTful API 구조

#### Base URL
```
http://localhost:5000/api
```

#### 엔드포인트

**Health Check**
- `GET /health` - 서버 상태 확인

**메뉴 (Menus)**
- `GET /menus` - 모든 메뉴 조회
- `GET /menus/:id` - 특정 메뉴 조회
- `POST /menus` - 메뉴 생성
- `PUT /menus/:id` - 메뉴 수정
- `DELETE /menus/:id` - 메뉴 삭제
- `PATCH /menus/:id/toggle-availability` - 품절 처리

**주문 (Orders)**
- `POST /orders` - 주문 생성
- `GET /orders` - 주문 목록 조회
- `GET /orders/:id` - 특정 주문 조회
- `PATCH /orders/:id/status` - 주문 상태 업데이트

**관리자 (Admin)**
- `GET /admin/dashboard` - 대시보드 통계
- `GET /admin/recent-orders` - 최근 주문 목록

---

## 5. 상태 관리

### Frontend (Zustand)

#### useMenuStore
- 메뉴 목록 관리
- 메뉴 조회 및 필터링
- 로딩 및 에러 상태

#### useOrderStore
- 장바구니 관리
- 주문 생성 및 조회
- 주문 상태 폴링

#### useAdminStore
- 대시보드 통계
- 최근 주문 목록

---

## 6. 주요 기능 플로우

### 주문 플로우

```
1. 고객이 메뉴 선택
   ↓
2. 장바구니에 추가
   ↓
3. 주문 생성 (POST /api/orders)
   ↓
4. 주문 상태: PENDING
   ↓
5. 관리자가 주문 확인
   ↓
6. 주문 상태: PREPARING
   ↓
7. 제조 완료
   ↓
8. 주문 상태: READY
   ↓
9. 고객 픽업
   ↓
10. 주문 상태: COMPLETED
```

### 재주문 플로우

```
1. 주문 내역에서 완료된 주문 선택
   ↓
2. "재주문" 버튼 클릭
   ↓
3. 해당 주문의 모든 항목이 장바구니에 추가
   ↓
4. 주문 페이지로 이동
   ↓
5. 필요시 수정 후 주문
```

---

## 7. 성능 최적화 전략

### Frontend
- 코드 스플리팅 (React Router)
- 이미지 지연 로딩
- 상태 관리 최적화 (Zustand)
- API 응답 캐싱

### Backend
- 데이터베이스 인덱싱
- 쿼리 최적화
- 에러 핸들링
- 로깅 및 모니터링

---

## 8. 보안 고려사항

- ✅ HTTPS 통신
- ✅ 입력 데이터 검증
- ✅ SQL Injection 방지 (Prisma ORM)
- ✅ CORS 설정
- ⏳ JWT 인증 (향후 추가)
- ⏳ Rate Limiting (향후 추가)

---

**리포트 작성일**: 2024-12-16

