# 백엔드 전환 가이드: Express → FastAPI

## 변경 사항 요약

프로젝트의 백엔드를 **Node.js/Express/TypeScript**에서 **Python/FastAPI**로 전환했습니다.

## 주요 변경 사항

### 기술 스택 변경

| 항목 | 이전 | 변경 후 |
|------|------|---------|
| 런타임 | Node.js | Python 3.11+ |
| 프레임워크 | Express | FastAPI |
| 언어 | TypeScript | Python |
| ORM | Prisma | SQLAlchemy |
| 마이그레이션 | Prisma Migrate | Alembic |
| 테스트 | Jest | pytest |
| 문서화 | 수동 | Swagger/ReDoc (자동) |

### 프로젝트 구조 변경

**이전 구조 (Express):**
```
backend/
├── src/
│   ├── controllers/
│   ├── routes/
│   ├── services/
│   └── index.ts
├── prisma/
│   └── schema.prisma
└── package.json
```

**변경 후 구조 (FastAPI):**
```
backend/
├── app/
│   ├── routers/        # 라우터 (이전 routes)
│   ├── services/       # 서비스 레이어
│   ├── models.py       # SQLAlchemy 모델 (이전 Prisma schema)
│   ├── schemas.py      # Pydantic 스키마
│   ├── database.py     # DB 설정
│   └── main.py         # FastAPI 앱 진입점
├── alembic/            # 마이그레이션 (이전 prisma migrations)
├── requirements.txt    # 의존성 (이전 package.json)
└── run.py              # 실행 스크립트
```

## 설치 및 실행

### 1. Python 환경 설정

```bash
# Python 가상 환경 생성 (권장)
python -m venv venv

# 가상 환경 활성화
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

### 2. 의존성 설치

```bash
cd backend
pip install -r requirements.txt
```

### 3. 환경 변수 설정

`.env` 파일 생성:
```env
DATABASE_URL=postgresql://user:password@localhost:5432/orderbean
PORT=5000
ENVIRONMENT=development
```

### 4. 서버 실행

```bash
# 개발 모드 (자동 재시작)
python run.py

# 또는
uvicorn app.main:app --reload --port 5000
```

### 5. API 문서 확인

- **Swagger UI**: http://localhost:5000/docs
- **ReDoc**: http://localhost:5000/redoc

## 데이터베이스 마이그레이션

### Alembic 초기화 (최초 1회)

```bash
cd backend
alembic init alembic
```

### 마이그레이션 생성 및 적용

```bash
# 마이그레이션 파일 생성
alembic revision --autogenerate -m "Initial migration"

# 마이그레이션 적용
alembic upgrade head
```

## 테스트

```bash
# 모든 테스트 실행
pytest

# 상세 출력
pytest -v

# 특정 파일만
pytest tests/test_menus.py
```

## 기존 파일 처리

기존 Node.js/Express 파일들은 다음 위치에 있습니다:
- `backend/src/` - TypeScript 소스 코드 (참고용)
- `backend/package.json` - Node.js 의존성 (참고용)
- `backend/prisma/` - Prisma 스키마 (참고용)

필요시 삭제하거나 백업할 수 있습니다.

## 주요 차이점

### 1. 비동기 처리
- **Express**: 콜백 또는 Promise
- **FastAPI**: async/await (Python 네이티브)

### 2. 타입 검증
- **Express**: 수동 검증 또는 Joi/Yup
- **FastAPI**: Pydantic 자동 검증

### 3. API 문서
- **Express**: 수동 작성 또는 Swagger 설정 필요
- **FastAPI**: 자동 생성 (Swagger/ReDoc)

### 4. ORM
- **Prisma**: 선언적 스키마, 타입 안정성
- **SQLAlchemy**: Python 네이티브, 유연한 쿼리

## 다음 단계

1. ✅ FastAPI 프로젝트 구조 생성
2. ✅ SQLAlchemy 모델 변환
3. ✅ 라우터 및 서비스 변환
4. ⏳ pytest 테스트 작성
5. ⏳ 실제 데이터베이스 연동
6. ⏳ 인증/세션 구현 (FastAPI Users, OAuth2)

## 참고 자료

- [FastAPI 공식 문서](https://fastapi.tiangolo.com/)
- [SQLAlchemy 문서](https://docs.sqlalchemy.org/)
- [Alembic 문서](https://alembic.sqlalchemy.org/)
- [Pydantic 문서](https://docs.pydantic.dev/)

